var twig=function(a){var b=a.id;if(a.debug!==void 0)Twig.debug=a.debug;if(a.data!==void 0)return new Twig.Template(a.data,b);else if(a.ref!==void 0){if(a.id!==void 0)throw Error("Both ref and id cannot be set on a twig.js template.");return Twig.Templates.load(a.ref)}else if(a.href!==void 0)return Twig.Templates.loadRemote(a.href,b,a.load,a.async,a.precompiled)};twig.compile=function(a,b){var d=b.filename,c=Twig.Templates.load(d)||new Twig.Template(a,d);return function(a){return c.render(a)}};
var Twig=function(a){function b(a,b){var e=Object.prototype.toString.call(b).slice(8,-1);return b!==void 0&&b!==null&&e===a}a.trace=false;a.debug=false;a.Error=function(a){this.message=a;this.type=this.name="TwigException"};a.Error.prototype.toString=function(){return this.name+": "+this.message};a.log={trace:function(){a.trace&&console&&console.log(Array.prototype.slice.call(arguments))},debug:function(){a.debug&&console&&console.log(Array.prototype.slice.call(arguments))}};a.token={};a.token.type=
{output:"output",logic:"logic",comment:"comment",raw:"raw"};a.token.definitions={output:{type:a.token.type.output,open:"{{",close:"}}"},logic:{type:a.token.type.logic,open:"{%",close:"%}"},comment:{type:a.token.type.comment,open:"{#",close:"#}"}};a.token.strings=['"',"'"];a.token.findStart=function(b){var c={position:null,def:null},e,f,g;for(e in a.token.definitions)if(a.token.definitions.hasOwnProperty(e)&&(f=a.token.definitions[e],g=b.indexOf(f.open),a.log.trace("Twig.token.findStart: ","Searching for ",
f.open," found at ",g),g>=0&&(c.position===null||g<c.position)))c.position=g,c.def=f;return c};a.token.findEnd=function(b,c,e){for(var f=null,g=false,h=0,i=null,k=null,j=null,l=i=null,i=null,m,n;!g;){k=i=null;j=b.indexOf(c.close,h);if(j>=0)f=j,g=true;else throw new a.Error("Unable to find closing bracket '"+c.close+"' opened near template position "+e);n=a.token.strings.length;for(m=0;m<n;m+=1)if(l=b.indexOf(a.token.strings[m],h),l>0&&l<j&&(i===null||l<i))i=l,k=a.token.strings[m];if(i!==null){i+=
1;f=null;for(g=false;;){i=b.indexOf(k,i);if(i<0)throw"Unclosed string in template";if(b.substr(i-1,1)!=="\\"){h=i+1;break}else i+=1}}}return f};a.tokenize=function(b){for(var c=[],e=0,f=null,g=null;b.length>0;)f=a.token.findStart(b),a.log.trace("Twig.tokenize: ","Found token: ",f),f.position!==null?(f.position>0&&c.push({type:a.token.type.raw,value:b.substring(0,f.position)}),b=b.substr(f.position+f.def.open.length),e+=f.position+f.def.open.length,g=a.token.findEnd(b,f.def,e),a.log.trace("Twig.tokenize: ",
"Token ends at ",g),c.push({type:f.def.type,value:b.substring(0,g).trim()}),b=b.substr(g+f.def.close.length),e+=g+f.def.close.length):(c.push({type:a.token.type.raw,value:b}),b="");return c};a.compile=function(b){for(var c=[],e=[],f=[],g=null,h=g=g=null,i=null,k=h=null,j=null,l=null;b.length>0;){g=b.shift();switch(g.type){case a.token.type.raw:e.length>0?f.push(g):c.push(g);break;case a.token.type.logic:g=a.logic.compile.apply(this,[g]);k=g.type;j=a.logic.handler[k].open;l=a.logic.handler[k].next;
a.log.trace("Twig.compile: ","Compiled logic token to ",g," next is: ",l," open is : ",j);if(j!==void 0&&!j){h=e.pop();i=a.logic.handler[h.type];if(i.next.indexOf(k)<0)throw Error(k+" not expected after a "+h.type);h.output=h.output||[];h.output=h.output.concat(f);f=[];h={type:a.token.type.logic,token:h};e.length>0?f.push(h):c.push(h)}if(l!==void 0&&l.length>0){a.log.trace("Twig.compile: ","Pushing ",g," to logic stack.");if(e.length>0)h=e.pop(),h.output=h.output||[],h.output=h.output.concat(f),e.push(h);
e.push(g)}else j!==void 0&&j&&(h={type:a.token.type.logic,token:g},e.length>0?f.push(h):c.push(h));break;case a.token.type.output:a.expression.compile.apply(this,[g]),e.length>0?f.push(g):c.push(g)}a.log.trace("Twig.compile: "," Output: ",c," Logic Stack: ",e," Pending Output: ",f)}if(e.length>0)throw g=e.pop(),Error("Unable to find an end tag for "+g.type+", expecting one of "+g.next.join(", "));return c};a.parse=function(b,c){var e=[],f=true,c=c||{};b.forEach(function(b){a.log.debug("Twig.parse: ",
"Parsing token: ",b);switch(b.type){case a.token.type.raw:e.push(b.value);break;case a.token.type.logic:b=a.logic.parse.apply(this,[b.token,c,f]);if(b.chain!==void 0)f=b.chain;if(b.context!==void 0)c=b.context;b.output!==void 0&&e.push(b.output);break;case a.token.type.output:e.push(a.expression.parse.apply(this,[b.stack,c]))}});return e.join("")};a.prepare=function(b){a.log.debug("Twig.prepare: ","Tokenizing ",b);b=a.tokenize.apply(this,[b]);a.log.debug("Twig.prepare: ","Compiling ",b);b=a.compile.apply(this,
[b]);a.log.debug("Twig.prepare: ","Compiled ",b);return b};a.Templates={registry:{}};a.Templates.save=function(b){if(b.id===void 0)throw new a.Error("Unable to save template with no id");a.Templates.registry[b.id]=b};a.Templates.load=function(b){return!a.Templates.registry.hasOwnProperty(b)?null:a.Templates.registry[b]};a.Templates.loadRemote=function(b,c,e,f,g){c===void 0&&(c=b);if(a.Templates.registry.hasOwnProperty(c))return a.Templates.registry[c];if(typeof XMLHttpRequest=="undefined")throw Error("Unsupported platform: Unable to do remote requests because there is no XMLHTTPRequest implementation");
var h=new XMLHttpRequest;h.onreadystatechange=function(){var b=null,b=null;h.readyState==4&&(a.log.debug("Got template ",h.responseText),b=g===true?JSON.parse(h.responseText):a.prepare(h.responseText),b=new a.Template(b,c),e&&e(b))};h.open("GET",b,f===true);h.send()};a.Template=function(d,c){this.tokens=b("String",d)?a.prepare.apply(this,[d]):d;this.id=c;this.render=function(b){return a.parse.apply(this,[this.tokens,b])};c!==void 0&&a.Templates.save(this)};return a}(Twig||{});
(function(){if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){if(this===void 0||this===null)throw new TypeError;var b=Object(this),d=b.length>>>0;if(d===0)return-1;var c=0;arguments.length>0&&(c=Number(arguments[1]),c!==c?c=0:c!==0&&c!==Infinity&&c!==-Infinity&&(c=(c>0||-1)*Math.floor(Math.abs(c))));if(c>=d)return-1;for(c=c>=0?c:Math.max(d-Math.abs(c),0);c<d;c++)if(c in b&&b[c]===a)return c;return-1};if(!Array.prototype.forEach)Array.prototype.forEach=function(a,b){var d,c;if(this==
null)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(d=b);for(c=0;c<f;){var g;c in e&&(g=e[c],a.call(d,g,c,e));c++}};if(!Object.keys)Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var b=[],d;for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.push(d);return b}})();
Twig=function(a){a.logic={};a.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set"};a.logic.definitions=[{type:a.logic.type.if_,regex:/^if\s+([^\s].+)$/,next:[a.logic.type.else_,a.logic.type.elseif,a.logic.type.endif],open:true,compile:function(b){b.stack=a.expression.compile.apply(this,[{type:a.expression.type.expression,value:b.match[1]}]).stack;
delete b.match;return b},parse:function(b,d,c){var e="",f=a.expression.parse.apply(this,[b.stack,d]),c=true;f===true&&(c=false,e=a.parse.apply(this,[b.output,d]));return{chain:c,output:e}}},{type:a.logic.type.elseif,regex:/^elseif\s+([^\s].*)$/,next:[a.logic.type.else_,a.logic.type.endif],open:false,compile:function(b){b.stack=a.expression.compile.apply(this,[{type:a.expression.type.expression,value:b.match[1]}]).stack;delete b.match;return b},parse:function(b,d,c){var e="";c&&a.expression.parse.apply(this,
[b.stack,d])===true&&(c=false,e=a.parse.apply(this,[b.output,d]));return{chain:c,output:e}}},{type:a.logic.type.else_,regex:/^else$/,next:[a.logic.type.endif,a.logic.type.endfor],open:false,parse:function(b,d,c){var e="";c&&(e=a.parse.apply(this,[b.output,d]));return{chain:c,output:e}}},{type:a.logic.type.endif,regex:/^endif$/,next:[],open:false},{type:a.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([^\s].+)$/,next:[a.logic.type.else_,a.logic.type.endfor],open:true,compile:function(b){var d=
b.match[1],c=b.match[2],e=null,e=null;b.key_var=null;b.value_var=null;if(d.indexOf(",")>=0)if(e=d.split(","),e.length===2)b.key_var=e[0].trim(),b.value_var=e[1].trim();else throw new a.Error("Invalid expression in for loop: "+d);else b.value_var=d;e=a.expression.compile.apply(this,[{type:a.expression.type.expression,value:c}]).stack;b.expression=e;delete b.match;return b},parse:function(b,d,c){var e=a.expression.parse.apply(this,[b.expression,d]),f=[],g;e instanceof Array?(g=0,e.forEach(function(c){d[b.value_var]=
c;b.key_var&&(d[b.key_var]=g);f.push(a.parse.apply(this,[b.output,d]));g+=1})):e instanceof Object&&(c=e._keys!==void 0?e._keys:Object.keys(e),c.forEach(function(c){c!=="_keys"&&e.hasOwnProperty(c)&&(d[b.value_var]=e[c],b.key_var&&(d[b.key_var]=c),f.push(a.parse.apply(this,[b.output,d])))}));c=f.length===0;return{chain:c,output:f.join("")}}},{type:a.logic.type.endfor,regex:/^endfor$/,next:[],open:false},{type:a.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*(.+)$/,next:[],open:true,compile:function(b){var d=
b.match[1].trim(),c=a.expression.compile.apply(this,[{type:a.expression.type.expression,value:b.match[2]}]).stack;b.key=d;b.expression=c;delete b.match;return b},parse:function(b,d,c){var e=a.expression.parse.apply(this,[b.expression,d]);d[b.key]=e;return{chain:c,context:d}}}];a.logic.handler={};a.logic.extendType=function(b,d){a.logic.type[b]=d||"Twig.logic.type"+b};for(a.logic.extend=function(b){if(!b.type)throw new a.Error("Unable to extend logic definition. No type provided for "+b);a.logic.handler[b.type]=
b};a.logic.definitions.length>0;)a.logic.extend(a.logic.definitions.shift());a.logic.compile=function(b){var b=b.value.trim(),b=a.logic.tokenize(b),d=a.logic.handler[b.type];d.compile&&(b=d.compile(b),a.log.trace("Twig.logic.compile: ","Compiled logic token to ",b));return b};a.logic.tokenize=function(b){var d={},c=null,e=null,f=null,g=null,f=f=null,b=b.trim();for(c in a.logic.handler)if(a.logic.handler.hasOwnProperty(c)){e=a.logic.handler[c].type;f=a.logic.handler[c].regex;g=[];for(f instanceof Array?
g=f:g.push(f);g.length>0;)if(f=g.shift(),f=f.exec(b.trim()),f!==null)return d.type=e,d.match=f,a.log.trace("Twig.logic.tokenize: ","Matched a ",e," regular expression of ",f),d}throw new a.Error("Unable to parse '"+b.trim()+"'");};a.logic.parse=function(b,d,c){var e="",f,d=d||{};a.log.debug("Twig.logic.parse: ","Parsing logic token ",b);f=a.logic.handler[b.type];f.parse&&(e=f.parse(b,d,c));return e};return a}(Twig||{});
Twig=function(a){a.expression={};a.expression.type={comma:"Twig.expression.type.comma",expression:"Twig.expression.type.expression",operator:"Twig.expression.type.operator",string:"Twig.expression.type.string",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},key:{period:"Twig.expression.type.key.period",
brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",setkey:"Twig.expression.type.setkey",test:"Twig.expression.type.test"};a.expression.set={operations:[a.expression.type.filter,a.expression.type.operator,a.expression.type.array.end,a.expression.type.object.end,a.expression.type.parameter.end,a.expression.type.comma,a.expression.type.setkey,a.expression.type.test],expressions:[a.expression.type.expression,
a.expression.type.string,a.expression.type.variable,a.expression.type.number,a.expression.type.array.start,a.expression.type.object.start]};a.expression.fn={compile:{push:function(b,a,c){c.push(b)}},parse:{push:function(b,a){a.push(b)},push_value:function(b,a){a.push(b.value)}}};a.expression.definitions=[{type:a.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_][a-zA-Z0-9_]*)/,next:a.expression.set.operations.concat([a.expression.type.parameter.start]),compile:function(b,a,c){b.filter=b.match[2];
b.modifier=b.match[1];delete b.match;delete b.value;c.push(b)},parse:function(b,d,c){var e=d.pop(),c=b.params&&a.expression.parse.apply(this,[b.params,c]),e=a.test(b.filter,e,c);b.modifier=="not"?d.push(!e):d.push(e)}},{type:a.expression.type.setkey,regex:/^\:/,next:a.expression.set.expressions,compile:function(b,d,c){d=c.pop();if(d.type!==a.expression.type.string)throw new a.Error("Unexpected object key: "+d);b.key=d.value;c.push(b)},parse:a.expression.fn.parse.push},{type:a.expression.type.comma,
regex:/^,/,next:a.expression.set.expressions,compile:function(b,a,c){for(;a.length>0;)c.push(a.pop());c.push(b)}},{type:a.expression.type.expression,regex:/^\(([^\)]+)\)/,next:a.expression.set.operations,compile:function(b,d,c){b.value=b.match[1];for(b=a.expression.compile(b).stack;b.length>0;)c.push(b.shift())}},{type:a.expression.type.operator,regex:/(^[\+\*\/\-\^~%]|^[<>!]=?|^==|^\|\||^&&)/,next:a.expression.set.expressions,compile:function(b,d,c){b=a.expression.operator.lookup(b.value,b);for(a.log.trace("Twig.expression.compile: ",
"Operator: ",b);d.length>0&&(b.associativity===a.expression.operator.leftToRight&&b.precidence>=d[d.length-1].precidence||b.associativity===a.expression.operator.rightToLeft&&b.precidence>d[d.length-1].precidence);)c.push(d.pop());d.push(b)},parse:function(b,d){a.expression.operator.parse(b.value,d)}},{type:a.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2.)*?\1/,next:a.expression.set.operations,compile:function(b,d,c){d=b.value;d=d.substring(0,1)==='"'?d.replace('\\"','"'):d.replace("\\'","'");
b.value=d.substring(1,d.length-1);a.log.trace("Twig.expression.compile: ","String value: ",b.value);c.push(b)},parse:a.expression.fn.parse.push_value},{type:a.expression.type.parameter.start,regex:/^\(/,next:a.expression.set.expressions.concat([a.expression.type.parameter.end]),compile:a.expression.fn.compile.push,parse:a.expression.fn.parse.push},{type:a.expression.type.parameter.end,regex:/^\)/,next:a.expression.set.operations,compile:function(b,d,c){for(;d.length>0;)c.push(d.pop());for(d=[];b.type!==
a.expression.type.parameter.start;)d.unshift(b),b=c.pop();d.unshift(b);b=c.pop();if(b.type!==a.expression.type.filter&&b.type!==a.expression.type.test)throw new a.Error("Expected filter before parameters, got "+b.type);b.params=d;c.push(b)},parse:function(b,d){for(var c=[],e=false,f=null;d.length>0;){f=d.pop();if(f.type&&f.type==a.expression.type.parameter.start){e=true;break}c.unshift(f)}if(!e)throw new a.Error("Expected end of parameter set.");d.push(c)}},{type:a.expression.type.array.start,regex:/^\[/,
next:a.expression.set.expressions.concat([a.expression.type.array.end]),compile:a.expression.fn.compile.push,parse:a.expression.fn.parse.push},{type:a.expression.type.array.end,regex:/^\]/,next:a.expression.set.operations.concat([a.expression.type.key.period,a.expression.type.key.brackets]),compile:function(b,a,c){for(;a.length>0;)c.push(a.pop());c.push(b)},parse:function(b,d){for(var c=[],e=false,f=null;d.length>0;){f=d.pop();if(f.type&&f.type==a.expression.type.array.start){e=true;break}c.unshift(f)}if(!e)throw new a.Error("Expected end of array.");
d.push(c)}},{type:a.expression.type.object.start,regex:/^\{/,next:a.expression.set.expressions.concat([a.expression.type.object.end]),compile:a.expression.fn.compile.push,parse:a.expression.fn.parse.push},{type:a.expression.type.object.end,regex:/^\}/,next:a.expression.set.operations.concat([a.expression.type.key.period,a.expression.type.key.brackets]),compile:function(b,a,c){for(;a.length>0;)c.push(a.pop());c.push(b)},parse:function(b,d){for(var c={},e=false,f=null,g=null;d.length>0;){f=d.pop();
if(f.type&&f.type===a.expression.type.object.start){e=true;break}if(f.type&&f.type===a.expression.type.setkey){if(g===null)throw new a.Error("Expected value for key "+f.key+" in object definition. Got "+f);c[f.key]=g;if(c._keys===void 0)c._keys=[];c._keys.unshift(f.key);g=null}else g=f}if(!e)throw new a.Error("Unexpected end of object.");d.push(c)}},{type:a.expression.type.filter,regex:/^\|[a-zA-Z_][a-zA-Z0-9_\-]*/,next:a.expression.set.operations.concat([a.expression.type.key.period,a.expression.type.key.brackets,
a.expression.type.parameter.start]),compile:function(b,a,c){b.value=b.value.substr(1);c.push(b)},parse:function(b,d,c){var e=d.pop(),c=b.params&&a.expression.parse.apply(this,[b.params,c]);d.push(a.filter(b.value,e,c))}},{type:a.expression.type.variable,regex:/^[a-zA-Z_][a-zA-Z0-9_]*/,next:a.expression.set.operations.concat([a.expression.type.key.period,a.expression.type.key.brackets]),compile:a.expression.fn.compile.push,parse:function(b,a,c){a.push(c[b.value])}},{type:a.expression.type.key.period,
regex:/^\.([a-zA-Z_][a-zA-Z0-9_]*)/,next:a.expression.set.operations.concat([a.expression.type.key.period,a.expression.type.key.brackets]),compile:function(b,a,c){b.key=b.match[1];delete b.match;delete b.value;c.push(b)},parse:function(b,d){var c=b.key,e=d.pop();if(e===null||e===void 0)throw new a.Error("Can't access a key "+c+" on an undefined object.");d.push(e[c])}},{type:a.expression.type.key.brackets,regex:/^\[([^\]]*)\]/,next:a.expression.set.operations.concat([a.expression.type.key.period,
a.expression.type.key.brackets]),compile:function(b,d,c){d=b.match[1];delete b.value;delete b.match;b.stack=a.expression.compile({value:d}).stack;c.push(b)},parse:function(b,d,c){b=a.expression.parse.apply(this,[b.stack,c]);c=d.pop();if(!c.hasOwnProperty(b))throw new a.Error("Model doesn't provide the key "+b);d.push(c[b])}},{type:a.expression.type.number,regex:/^\-?\d*\.?\d+/,next:a.expression.set.operations,compile:a.expression.fn.compile.push,parse:a.expression.fn.parse.push_value}];a.expression.handler=
{};a.expression.extendType=function(b){a.expression.type[b]="Twig.expression.type."+b};for(a.expression.extend=function(b){if(!b.type)throw new a.Error("Unable to extend logic definition. No type provided for "+b);a.expression.handler[b.type]=b};a.expression.definitions.length>0;)a.expression.extend(a.expression.definitions.shift());a.expression.tokenize=function(b){var d=[],c=0,e=null,f,g,h,i,k,j=[],l;l=function(){var b=Array.prototype.slice.apply(arguments);b.pop();b.pop();a.log.trace("Twig.expression.tokenize",
"Matched a ",f," regular expression of ",b);if(e&&e.indexOf(f)<0)return j.push(f+" cannot follow a "+d[d.length-1].type+" at template:"+c+" near '"+b[0].substring(0,20)+"...'"),b[0];j=[];d.push({type:f,value:b[0],match:b});k=true;e=i;c+=b[0].length;return""};for(a.log.debug("Twig.expression.tokenize","Tokenizing expression ",b);b.length>0;){b=b.trim();for(f in a.expression.handler)if(a.expression.handler.hasOwnProperty(f)){i=a.expression.handler[f].next;g=a.expression.handler[f].regex;a.log.trace("Checking type ",
f," on ",b);h=g instanceof Array?g:[g];for(k=false;h.length>0;)g=h.pop(),b=b.replace(g,l);if(k)break}if(!k)if(j.length>0)throw new a.Error(j.join(" OR "));else throw new a.Error("Unable to parse '"+b+"' at template position"+c);}a.log.trace("Twig.expression.tokenize","Tokenized to ",d);return d};a.expression.compile=function(b){var d=b.value,c=a.expression.tokenize(d),e=null,f=[],g=[],h=null;a.log.trace("Twig.expression.compile: ","Compiling ",d);for(a.log.trace("Twig.expression.compile: ","Tokens tokenized to ",
c);c.length>0;)e=c.shift(),h=a.expression.handler[e.type],h.compile&&h.compile(e,g,f);for(;g.length>0;)f.push(g.pop());a.log.trace("Twig.expression.compile: ","Stack is",f);b.stack=f;delete b.value;return b};a.expression.parse=function(b,d){b instanceof Array||(b=[b]);var c=[],e=null;b.forEach(function(b){e=a.expression.handler[b.type];e.parse&&e.parse.apply(this,[b,c,d])});return c.pop()};return a}(Twig||{});
Twig=function(a){a.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};a.expression.operator.lookup=function(b,d){switch(b){case ",":d.precidence=18;d.associativity=a.expression.operator.leftToRight;break;case "?":case ":":d.precidence=16;d.associativity=a.expression.operator.rightToLeft;break;case "||":d.precidence=14;d.associativity=a.expression.operator.leftToRight;break;case "&&":d.precidence=13;d.associativity=a.expression.operator.leftToRight;break;case "==":case "!=":d.precidence=
9;d.associativity=a.expression.operator.leftToRight;break;case "<":case "<=":case ">":case ">=":d.precidence=8;d.associativity=a.expression.operator.leftToRight;break;case "~":case "+":case "-":d.precidence=6;d.associativity=a.expression.operator.leftToRight;break;case "*":case "/":case "%":d.precidence=5;d.associativity=a.expression.operator.leftToRight;break;case "!":d.precidence=3;d.associativity=a.expression.operator.rightToLeft;break;default:throw new a.Error(b+" is an unknown operator.");}d.operator=
b;return d};a.expression.operator.parse=function(b,d){a.log.trace("Twig.expression.operator.parse: ","Handling ",b);var c,e;switch(b){case "+":e=parseFloat(d.pop());c=parseFloat(d.pop());d.push(c+e);break;case "-":e=parseFloat(d.pop());c=parseFloat(d.pop());d.push(c-e);break;case "*":e=parseFloat(d.pop());c=parseFloat(d.pop());d.push(c*e);break;case "/":e=parseFloat(d.pop());c=parseFloat(d.pop());d.push(c/e);break;case "%":e=parseFloat(d.pop());c=parseFloat(d.pop());d.push(c%e);break;case "~":e=d.pop().toString();
c=d.pop().toString();d.push(c+e);break;case "!":d.push(!d.pop());break;case "<":e=d.pop();c=d.pop();d.push(c<e);break;case "<=":e=d.pop();c=d.pop();d.push(c<=e);break;case ">":e=d.pop();c=d.pop();d.push(c>e);break;case ">=":e=d.pop();c=d.pop();d.push(c>=e);break;case "==":e=d.pop();c=d.pop();d.push(c==e);break;case "!=":e=d.pop();c=d.pop();d.push(c!=e);break;case "||":e=d.pop();c=d.pop();d.push(c||e);break;case "&&":e=d.pop(),c=d.pop(),d.push(c&&e)}};return a}(Twig||{});
Twig=function(a){a.filters={upper:function(b){return b.toUpperCase()},lower:function(b){return b.toLowerCase()},capitalize:function(b){return b.substr(0,1).toUpperCase()+b.substr(1)},title:function(b){return b.replace(/(^|\s)([a-z])/g,function(b,a,e){return a+e.toUpperCase()})},length:function(b){if(b instanceof Array||typeof b==="string")return b.length;else if(b instanceof Object)return b._keys===void 0?Object.keys(b).length:b._keys.length},reverse:function(b){if(b instanceof Array)return b.reverse();
else if(b instanceof Object){var a=b._keys||Object.keys(b).reverse();b._keys=a;return b}},sort:function(b){if(b instanceof Array)return b.sort();else if(b instanceof Object){var a=Object.keys(b).sort(function(a,d){return b[a]>b[d]});a.forEach(function(){});b._keys=a;return b}},keys:function(b){var a=[];(b._keys||Object.keys(b)).forEach(function(c){c!=="_keys"&&b.hasOwnProperty(c)&&a.push(c)});return a},url_encode:function(b){return encodeURIComponent(b)},join:function(b,a){var c="",e=[],f=null;a&&
a[0]&&(c=a[0]);b instanceof Array?e=b:(f=b._keys||Object.keys(b),f.forEach(function(a){a!=="_keys"&&b.hasOwnProperty(a)&&e.push(b[a])}));return e.join(c)},"default":function(b,d){if(d===void 0||d.length!==1)throw new a.Error("default filter expects one argument");return b===void 0||b===null||b===""?d[0]:b},json_encode:function(b){delete b._keys;return JSON.stringify(b)},merge:function(b,d){var c=[],e=0,f=[];b instanceof Array?d.forEach(function(b){b instanceof Array||(c={})}):c={};if(!(c instanceof
Array))c._keys=[];b instanceof Array?b.forEach(function(b){c._keys&&c._keys.unshift(e);c[e]=b;e++}):(f=b._keys||Object.keys(b),f.forEach(function(a){c[a]=b[a];c._keys.push(a);a=parseInt(a,10);!isNaN(a)&&a>=e&&(e=a+1)}));d.forEach(function(b){b instanceof Array?b.forEach(function(b){c._keys&&c._keys.push(e);c[e]=b;e++}):(f=b._keys||Object.keys(b),f.forEach(function(a){c[a]||c._keys.unshift(a);c[a]=b[a];a=parseInt(a,10);!isNaN(a)&&a>=e&&(e=a+1)}))});if(d.length===0)throw new a.Error("Filter merge expects at least one parameter");
return c}};a.filter=function(b,d,c){if(!a.filters[b])throw"Unable to find filter "+b;return a.filters[b](d,c)};return a}(Twig||{});
Twig=function(a){a.tests={empty:function(b){if(b===null||b===void 0)return true;if(b.length&&b.length>0)return false;for(var a in b)if(b.hasOwnProperty(a))return false;return true},odd:function(b){return b%2===1},even:function(b){return b%2===0},divisibleby:function(b,a){return b%a[0]===0},defined:function(a){return a!==void 0},none:function(a){return a===null}};a.test=function(b,d,c){if(!a.tests[b])throw"Test "+b+" is not defined.";return a.tests[b](d,c)};return a}(Twig||{});
typeof module!=="undefined"&&module.exports?module.exports=twig:window.twig=twig;
